/*************************************************************************
**************************************************************************
**************************************************************************
******                                                                
******  BEAMLINE:  C++ objects for design and analysis
******             of beamlines, storage rings, and   
******             synchrotrons.                      
******                                    
******  File:      Particle.cc
******                                                                
******  Copyright Universities Research Association, Inc./ Fermilab    
******            All Rights Reserved                             
*****
******  Usage, modification, and redistribution are subject to terms          
******  of the License supplied with this software.
******  
******  Software and documentation created under 
******  U.S. Department of Energy Contract No. DE-AC02-76CH03000. 
******  The U.S. Government retains a world-wide non-exclusive, 
******  royalty-free license to publish or reproduce documentation 
******  and software for U.S. Government purposes. This software 
******  is protected under the U.S. and Foreign Copyright Laws.
******                                                                
******                                                                
******  Authors:   Leo Michelotti (Original version)                                     
******             Jean-Francois Ostiguy
******                                                   
******             Fermilab                                           
******             P.O.Box 500                                        
******             Mail Stop 220                                      
******             Batavia, IL   60510                                
******                                                                
******             Phone: (630) 840 4956                              
******             Email: michelotti@fnal.gov                         
******                                                                
******
******  REVISION HISTORY:
******
******  Dec 2006 ostiguy@fnal.gov                                                                
******
******  Major revision 
****** 
******  - use covariant return types for Clone()
******  - eliminated ConvertToXXX() type conversion functions; 
******    use explicit mixed type constructors instead.
******  - take max advantage of constructor member initialization (useful 
******    for bunches, since a lot of particles may be instantiated)
******  - streamlined public interface. Eliminated members
******    with raw ptr as argument(s) when possible.
******  - use Vector and Mapping to store state info instead of raw
*****     arrays.    
******  - elements no longer declared friends. Doing so breaks encapsulation 
******    with no real benefit. Propagators should use access function to 
******    change state. There is no significant penalty, if any.       
******  - use empty core_access class as access control mechanism 
******                                                                
******  Oct 2007 ostiguy@fnal.gov
******  - private allocator for state_ vector  
******  May 2008 ostiguy@fnal.gov
******  - particle charge initialized in base class
******  - brho is now a signed quantity so that a propagator 
******    does not need to check neither the sign nor the magnitude 
******    of the charge.
**************************************************************************
*************************************************************************/

#include <basic_toolkit/PhysicsConstants.h>
#include <basic_toolkit/GenericException.h>
#include <beamline/Particle.h>
#include <beamline/JetParticle.h>
#include <mxyzptlk/Jet__environment.h>


using namespace PhysicsConstants;
using namespace std;
using FNAL::pcerr;
using FNAL::pcout;


// **************************************************
//   class Particle
// **************************************************

int const  Particle::PSD = 6;
int const    BMLN_dynDim = 6;


//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Particle::Particle( double const& mass, double const& charge, double const& momentum ) 
:  
   lost_(false),
    tag_(""),   
      q_(charge),   
      m_(mass), 
      p_(momentum ), 
  gamma_(ReferenceEnergy()/m_), 
   beta_( sqrt( 1.0 - 1.0 / (gamma_*gamma_)) ), 
   bRho_(  p_/ ( q_/PH_MKS_e* PH_CNV_brho_to_p ) ), 
  state_(PSD)


{
 for( int i = 0; i < BMLN_dynDim; i++ ) state_[i] = 0.0;

 if( momentum < 0.0 ) {
  ostringstream uic;
  uic  << "Momentum, " << momentum << " GeV, is <= 0.0";
  uic  << "Energy, " << ReferenceEnergy() << " GeV, is less than mass, " << m_ << " GeV.";
  throw(  GenericException( __FILE__, __LINE__, 
         "Particle::Particle( double, double )", 
          uic.str().c_str() ) );
 }

}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Particle::Particle( double const& mass, double const& charge, double const& momentum, Vector const& s ) 
:
   lost_(false),
    tag_(""),   
      q_(charge),   
      m_(mass), 
      p_( momentum ), 
  gamma_( ReferenceEnergy()/m_ ), 
   beta_( sqrt( 1.0 - 1.0 / ( gamma_*gamma_ ) )), 
   bRho_( p_ / ( q_/PH_MKS_e * PH_CNV_brho_to_p )), 
  state_(PSD)

{

 for( int i = 0; i < BMLN_dynDim; i++ ) state_[i] = s[i];

 if( momentum < 0.0 ) {
  ostringstream uic;
  uic  << "Momentum, " << momentum << " GeV, is <= 0.0";
  throw(  GenericException( __FILE__, __LINE__, 
         "Particle::Particle( double, double, Vector const& )", 
         uic.str().c_str() ) );
 }

}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Particle::Particle( Particle const& u ) 
:
   lost_(u.lost_),
    tag_(u.tag_),   
      q_(u.q_),   
      m_(u.m_), 
      p_(u.p_), 
  gamma_(u.gamma_), 
   beta_(u.beta_), 
   bRho_(u.bRho_), 
  state_(u.state_)
{ }

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Particle::Particle( JetParticle const& u ) 
:  
  lost_(u.lost_),
   tag_(u.tag_), 
     q_(u.q_),
     m_(u.m_), 
     p_(u.p_), 
 gamma_(u.gamma_), 
  beta_(u.beta_), 
  bRho_(u.bRho_)
{
  state_ = u.state_.standardPart();

}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Particle* Particle::Clone( void* p) const  
{ 
   return p ? new (p) Particle(*this) : new Particle(*this); 
}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Particle::~Particle() 
{ }

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

void Particle::dtor() 
{
  this->~Particle();
}
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Particle& Particle::operator=( Particle const& p ) 
{

  if( &p == this ) return *this;

  lost_  = p.lost_,
  tag_   = p.tag_;
  q_     = p.q_;
  p_     = p.p_;
  m_     = p.m_;
  bRho_  = p.bRho_;
  beta_  = p.beta_;
  gamma_ = p.gamma_;
  state_ = p.state_;  

 return *this;

}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

void Particle::setStateToZero() {
 for( int i = 0; i < BMLN_dynDim; i++ )  state_[i] = 0.0;
} 

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

void Particle::SetReferenceEnergy( double const& energy ) 
{

  if( energy < m_ ) {
    ostringstream uic;
    uic  << "Energy, " << energy << " GeV, is less than mass, " << m_ << " GeV.";
    throw( GenericException( __FILE__, __LINE__, 
         "void Particle::SetReferenceEnergy( double )", 
         uic.str().c_str() ) );
  }

 gamma_ = energy / m_;
 beta_  = sqrt( 1.0 - 1.0 / ( gamma_*gamma_ ) );
 p_     = energy * beta_;
 bRho_  = p_ / ( q_/PH_MKS_e * PH_CNV_brho_to_p );
}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

void Particle::SetReferenceMomentum( double const& p ) 
{

 p_     = p;
 bRho_  = p_ / ( q_/PH_MKS_e * PH_CNV_brho_to_p );
 gamma_ = ReferenceEnergy() / m_;
 beta_  = sqrt( 1.0 - 1.0 / ( gamma_*gamma_ ) );
}


//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Vector Particle::VectorBeta() const
{
 return VectorMomentum()/Energy();
}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Vector Particle::VectorMomentum() const
{
 Vector ret(3);

 ret[0] = p_ * state_[3];
 ret[1] = p_ * state_[4];
 ret[2] = p_ * get_npz();

 return ret;
}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Vector Particle::NormalizedVectorMomentum() const
{

 Vector ret(3);

 ret[0] = state_[3];
 ret[1] = state_[4];
 ret[2] = get_npz();

 return ret;

}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

std::string const& Particle::getTag() const
{
  return tag_;
}                         

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

void   Particle::setTag(std::string const& tag)
{
  tag_ = tag; 
}     

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

// **************************************************
//   class Proton
// **************************************************

Proton::Proton() 
 : Particle( PH_NORM_mp , PH_MKS_e, PH_NORM_mp) 
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Proton::Proton( double const& momentum ) 
 : Particle( PH_NORM_mp, PH_MKS_e, momentum )
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Proton::Proton( double const& momentum, Vector const& s ) 
 : Particle( PH_NORM_mp, PH_MKS_e, momentum, s )
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Proton::Proton( Proton const& u ) 
 : Particle( u ) 
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Proton::Proton( JetProton const &p )
 : Particle(p) 
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Proton*           Proton::Clone(void* p)  const 
{ 
  return p ? new(p) Proton( *this )     : new Proton(*this );     
}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||


Proton::~Proton() 
{}


//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Proton& Proton::operator=(Proton const& p) 
{

  if ( &p == this ) return *this;

  Particle::operator=(p);
 
  return *this;
}

// **************************************************
//   class AntiProton
// **************************************************


//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

AntiProton::AntiProton() 
 : Particle( PH_NORM_mp,  - PH_MKS_e, PH_NORM_mp ) 
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

AntiProton::AntiProton( double const& momentum ) 
 : Particle( PH_NORM_mp,  - PH_MKS_e, momentum )
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

AntiProton::AntiProton( double const& momentum, Vector const& s ) 
 : Particle( PH_NORM_mp,  - PH_MKS_e, momentum, s )
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

AntiProton::AntiProton( AntiProton const& u ) 
 : Particle( u ) 
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||


AntiProton::AntiProton( JetAntiProton const& p)
 : Particle(p) 
{}


//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

AntiProton*   AntiProton::Clone(void* p)    const 
{ 
  return p ? new(p) AntiProton( *this ) : new AntiProton(*this);  
}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

AntiProton::~AntiProton() {
}


//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

AntiProton& AntiProton::operator=(AntiProton const& p) 
{

  if ( &p == this ) return *this;

  Particle::operator=(p);
 
  return *this;

}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

// **************************************************
//   class Electron
// **************************************************

Electron::Electron() 
 : Particle ( PH_NORM_me,   - PH_MKS_e, PH_NORM_me )
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Electron::Electron( double const& W ) 
 : Particle( PH_NORM_me, -PH_MKS_e, W )
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Electron::Electron( double const& W, Vector const& s ) 
: Particle( PH_NORM_me, - PH_MKS_e, W, s )
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Electron::Electron( Electron const& u ) 
 : Particle( u ) 
{ }

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||


Electron::Electron( JetElectron const& p)
 : Particle(p) 
{}


//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Electron*       Electron::Clone(void* p)    const 
{ 
  return p ? new(p) Electron( *this )   : new Electron( *this );  
}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Electron::~Electron() {}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Electron& Electron::operator=(Electron const& p) {

  if ( &p == this ) return *this;

  Particle::operator=(p);
 
  return *this;

}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||


// **************************************************
//   class Positron
// **************************************************

Positron::Positron() 
: Particle ( PH_NORM_me, PH_MKS_e, PH_NORM_me )
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Positron::Positron( double const& momentum ) 
 : Particle( PH_NORM_me,  PH_MKS_e, momentum )
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Positron::Positron( double const& momentum, Vector const& s ) 
: Particle( PH_NORM_me,  PH_MKS_e, momentum, s )
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Positron::Positron( Positron const& u ) 
: Particle( u ) 
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Positron::Positron( JetPositron const& p)
: Particle(p) {}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Positron*       Positron::Clone(void* p)    const 
{ 
   return p ? new(p) Positron( *this ) : new Positron(*this) ;   
}
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Positron::~Positron() 
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||


Positron& Positron::operator=(Positron const& p) 
{

  if ( &p == this ) return *this;

  Particle::operator=(p);
 
  return *this;
}

// **************************************************
//   class Muon
// **************************************************


//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Muon::Muon() 
: Particle( PH_NORM_mmu,   -PH_MKS_e, PH_NORM_mmu ) 
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Muon::Muon( double const& momentum ) 
: Particle( PH_NORM_mmu, -PH_MKS_e, momentum )
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Muon::Muon( double const& momentum, Vector const& s ) 
: Particle( PH_NORM_mmu,-PH_MKS_e,  momentum, s )
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Muon::Muon( Muon const& u ) : Particle( u ) {
}
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Muon::Muon(JetMuon const& p): Particle(p) {} 


//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Muon*  Muon::Clone(void* p)  const 
{ 
  return p ? new(p) Muon( *this ) : new Muon( *this );      
}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Muon::~Muon() 
{}


//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Muon& Muon::operator=(Muon const& p) {

  if ( &p == this ) return *this;

  Particle::operator=(p);
 
  return *this;

}

// **************************************************
//   class AntiMuon
// **************************************************


AntiMuon::AntiMuon() 
: Particle( PH_NORM_mmu, PH_MKS_e, PH_NORM_mmu ) 
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

AntiMuon::AntiMuon( double const& momentum ) 
: Particle( PH_NORM_mmu,  PH_MKS_e, momentum )
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

AntiMuon::AntiMuon( double const& momentum, Vector const& s ) 
: Particle( PH_NORM_mmu,  PH_MKS_e, momentum, s )
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

AntiMuon::AntiMuon( AntiMuon const& u ) 
: Particle( u ) 
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

AntiMuon::AntiMuon( JetAntiMuon const & p)
: Particle(p) 
{}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

AntiMuon* AntiMuon::Clone(void* p) const 
{ 
  return p ? new(p) AntiMuon( *this )   : new AntiMuon( *this );  
}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

AntiMuon::~AntiMuon() 
{}


//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||


AntiMuon& AntiMuon::operator=(AntiMuon const& p) {

  if ( &p == this ) return *this;

  Particle::operator=(p);
 
  return *this;
}

//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
//||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

